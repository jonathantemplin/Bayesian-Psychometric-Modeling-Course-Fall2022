<!DOCTYPE html>
<html lang="en"><head>
<script src="04e_Modeling_Multidimensional_Latent_Variables_files/libs/clipboard/clipboard.min.js"></script>
<script src="04e_Modeling_Multidimensional_Latent_Variables_files/libs/quarto-html/tabby.min.js"></script>
<script src="04e_Modeling_Multidimensional_Latent_Variables_files/libs/quarto-html/popper.min.js"></script>
<script src="04e_Modeling_Multidimensional_Latent_Variables_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="04e_Modeling_Multidimensional_Latent_Variables_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="04e_Modeling_Multidimensional_Latent_Variables_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="04e_Modeling_Multidimensional_Latent_Variables_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.1.189">

  <meta name="author" content="Lecture 4e">
  <title>Generalized Measurement Models: Modeling Multidimensional Latent Variables</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="04e_Modeling_Multidimensional_Latent_Variables_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="04e_Modeling_Multidimensional_Latent_Variables_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="04e_Modeling_Multidimensional_Latent_Variables_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="04e_Modeling_Multidimensional_Latent_Variables_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="04e_Modeling_Multidimensional_Latent_Variables_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="04e_Modeling_Multidimensional_Latent_Variables_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="04e_Modeling_Multidimensional_Latent_Variables_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="center">
  <h1 class="title">Generalized Measurement Models: Modeling Multidimensional Latent Variables</h1>
  <p class="author">Lecture 4e</p>
</section>

<section id="todays-lecture-objectives" class="slide level2">
<h2>Today’s Lecture Objectives</h2>
<ol type="1">
<li>Show how to estimate multidimensional latent variable models with polytomous data</li>
</ol>
</section>
<section id="example-data-conspiracy-theories" class="slide level2">
<h2>Example Data: Conspiracy Theories</h2>
<p>Today’s example is from a bootstrap resample of 177 undergraduate students at a large state university in the Midwest. The survey was a measure of 10 questions about their beliefs in various conspiracy theories that were being passed around the internet in the early 2010s. Additionally, gender was included in the survey. All items responses were on a 5- point Likert scale with:</p>
<ol type="1">
<li>Strongly Disagree</li>
<li>Disagree</li>
<li>Neither Agree or Disagree</li>
<li>Agree</li>
<li>Strongly Agree</li>
</ol>
<h4 id="please-note-the-purpose-of-this-survey-was-to-study-individual-beliefs-regarding-conspiracies.-the-questions-can-provoke-some-strong-emotions-given-the-world-we-live-in-currently.-all-questions-were-approved-by-university-irb-prior-to-their-use.">Please note, the purpose of this survey was to study individual beliefs regarding conspiracies. The questions can provoke some strong emotions given the world we live in currently. All questions were approved by university IRB prior to their use.</h4>
<p>Our purpose in using this instrument is to provide a context that we all may find relevant as many of these conspiracy theories are still prevalent today.</p>
</section>
<section id="conspiracy-theory-questions-1-5" class="slide level2">
<h2>Conspiracy Theory Questions 1-5</h2>
<p>Questions:</p>
<ol type="1">
<li>The U.S. invasion of Iraq was not part of a campaign to fight terrorism, but was driven by oil companies and Jews in the U.S. and Israel.</li>
<li>Certain U.S. government officials planned the attacks of September 11, 2001 because they wanted the United States to go to war in the Middle East.</li>
<li>President Barack Obama was not really born in the United States and does not have an authentic Hawaiian birth certificate.</li>
<li>The current financial crisis was secretly orchestrated by a small group of Wall Street bankers to extend the power of the Federal Reserve and further their control of the world’s economy.</li>
<li>Vapor trails left by aircraft are actually chemical agents deliberately sprayed in a clandestine program directed by government officials.</li>
</ol>
</section>
<section id="conspiracy-theory-questions-6-10" class="slide level2">
<h2>Conspiracy Theory Questions 6-10</h2>
<p>Questions:</p>
<ol start="6" type="1">
<li>Billionaire George Soros is behind a hidden plot to destabilize the American government, take control of the media, and put the world under his control.</li>
<li>The U.S. government is mandating the switch to compact fluorescent light bulbs because such lights make people more obedient and easier to control.</li>
<li>Government officials are covertly Building a 12-lane "NAFTA superhighway" that runs from Mexico to Canada through America’s heartland.</li>
<li>Government officials purposely developed and spread drugs like crack-cocaine and diseases like AIDS in order to destroy the African American community.</li>
<li>God sent Hurricane Katrina to punish America for its sins.</li>
</ol>
</section>
<section id="section" class="slide level2" data-auto-animate="true," data-visibility="uncounted">
<h2 data-id="quarto-animate-title"></h2>
<div style="margin-top: 200px; font-size: 3em; color: red;">
<p>Latent Variables</p>
</div>
</section>
<section id="the-latent-variables" class="slide level2">
<h2>The Latent Variables</h2>
<p>Latent variables are built by specification:</p>
<ul>
<li>What is their distribution? (nearly all are normally distributed)</li>
<li>How do you specify their scale: mean and standard deviation? (step two in our model analysis steps)</li>
</ul>
<p>You create latent variables by specifying which items measure which latent variables in an analysis model</p>
<ul>
<li>Called different names by different fields:
<ul>
<li>Alignment (educational measurement)</li>
<li>Factor pattern matrix (factor analysis)</li>
<li>Q-matrix (Question matrix; diagnostic models and multidimensional IRT)</li>
</ul></li>
</ul>
</section>
<section id="from-q-matrix-to-model" class="slide level2">
<h2>From Q-matrix to Model</h2>
<p>The alignment provides a specification of which latent variables are measured by which items</p>
<ul>
<li>Sometimes we say items “load onto” factors</li>
</ul>
<p>The mathematical definition of either of these terms is simply whether or not a latent variable appears as a predictor for an item</p>
<ul>
<li>For instance, item one appears to measure nongovernment conspiracies, meaning its alignment (row vector of the Q-matrix) would be:</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   Gov NonGov 
     0      1 </code></pre>
</div>
</div>
<p>The model for the first item is then built with only the factors measured by the item as being present:</p>
<p><span class="math display">\[
f(E\left(Y_{p1} \mid \boldsymbol{\theta}_p\right) ) = \mu_1 + \lambda_{11} \theta_{p1}
\]</span></p>
</section>
<section id="from-q-matrix-to-model-1" class="slide level2">
<h2>From Q-matrix to Model</h2>
<p>The model for the first item is then built with only the factors measured by the item as being present:</p>
<p><span class="math display">\[
f(E\left(Y_{p1} \mid \boldsymbol{\theta}_p\right) ) = \mu_1 + \lambda_{11} \theta_{p1}
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\mu_1\)</span> is the item intercept</li>
<li><span class="math inline">\(\lambda_{11}\)</span> is the factor loading for item 1 (the first subscript) for factor 1 (the second subscript)</li>
<li><span class="math inline">\(\theta_{p1}\)</span> is the value of the latent variable for person <span class="math inline">\(p\)</span> and factor 1</li>
</ul>
<p>The second factor is not included in the model for the item.</p>
</section>
<section id="more-q-matrix-stuff" class="slide level2">
<h2>More Q-matrix Stuff</h2>
<p>We could show the model with the Q-matrix entries:</p>
<p><span class="math display">\[
f(E\left(Y_{p1} \mid \boldsymbol{\theta}_p\right) ) = \mu_1 + q_{11}\left( \lambda_{11} \theta_{p1} \right) + q_{12}\left( \lambda_{12} \theta_{p2} \right) = \mu_1 + \boldsymbol{\theta}_p  \text{diag}\left(\boldsymbol{q}_i \right) \boldsymbol{\lambda}_{1}
\]</span></p>
<p>Where:</p>
<ul>
<li><p><span class="math inline">\(\boldsymbol{\lambda}_{1} = \left[ \begin{array}{c} \lambda_{11} \\ \lambda_{12} \end{array} \right]\)</span> contains all <em>possible</em> factor loadings for item 1 (size <span class="math inline">\(2 \times 1\)</span>)</p></li>
<li><p><span class="math inline">\(\boldsymbol{\theta}_p = \left[ \begin{array}{cc} \theta_{p1} &amp; \theta_{p2} \\ \end{array} \right]\)</span> contains the factor scores for person <span class="math inline">\(p\)</span> (size <span class="math inline">\(1 \times 2\)</span>)</p></li>
<li><p><span class="math inline">\(\text{diag}\left(\boldsymbol{q}_i \right) = \boldsymbol{q}_i \left[ \begin{array}{cc} 1 &amp; 0 \\ 0 &amp; 1 \end{array} \right] = \left[ \begin{array}{cc} 0 &amp; 1 \\ \end{array} \right] \left[ \begin{array}{cc} 1 &amp; 0 \\ 0 &amp; 1 \end{array} \right] = \left[ \begin{array}{cc} 0 &amp; 0 \\ 0 &amp; 1 \end{array} \right]\)</span> is a diagonal matrix of ones times the vector of Q-matrix entries for item 1</p></li>
</ul>
<p>The matrix product then gives:</p>
<p><span class="math display">\[\boldsymbol{\theta}_p  \text{diag}\left(\boldsymbol{q}_i \right) \boldsymbol{\lambda}_{1} = \left[
\begin{array}{cc}
\theta_{p1}  &amp; \theta_{p2} \\
\end{array}
\right]\left[
\begin{array}{cc}
0  &amp; 0 \\
0 &amp; 1
\end{array}
\right] \left[
\begin{array}{c}
\lambda_{11} \\
\lambda_{12}
\end{array}
\right] = \left[
\begin{array}{cc}
\theta_{p1}  &amp; \theta_{p2} \\
\end{array}
\right]\left[
\begin{array}{c}
0 \\
\lambda_{12}
\end{array}
\right] = \lambda_{12}\theta_{p2}\]</span></p>
<p>The Q-matrix functions like a partial version of the model (predictor) matrix that we saw in linear models</p>
</section>
<section id="todays-q-matrix" class="slide level2">
<h2>Today’s Q-matrix</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>       Gov NonGov
item1    0      1
item2    1      0
item3    0      1
item4    0      1
item5    1      0
item6    0      1
item7    1      0
item8    1      0
item9    1      0
item10   0      1</code></pre>
</div>
</div>
<p>Given the Q-matrix each item has its own model using the alignment specifications</p>
<p><span class="math display">\[
\begin{array}{c}
f(E\left(Y_{p1} \mid \boldsymbol{\theta}_p\right) ) =  \mu_1 + \lambda_{12} \theta_{p2} \\
f(E\left(Y_{p2} \mid \boldsymbol{\theta}_p\right) ) =  \mu_2 + \lambda_{21} \theta_{p1} \\
f(E\left(Y_{p3} \mid \boldsymbol{\theta}_p\right) ) =  \mu_3 + \lambda_{32} \theta_{p2} \\
f(E\left(Y_{p4} \mid \boldsymbol{\theta}_p\right) ) =  \mu_4 + \lambda_{42} \theta_{p2} \\
f(E\left(Y_{p5} \mid \boldsymbol{\theta}_p\right) ) =  \mu_5 + \lambda_{51} \theta_{p1} \\
f(E\left(Y_{p6} \mid \boldsymbol{\theta}_p\right) ) =  \mu_6 + \lambda_{62} \theta_{p2} \\
f(E\left(Y_{p7} \mid \boldsymbol{\theta}_p\right) ) =  \mu_7 + \lambda_{71} \theta_{p1} \\
f(E\left(Y_{p8} \mid \boldsymbol{\theta}_p\right) ) =  \mu_8 + \lambda_{81} \theta_{p1} \\
f(E\left(Y_{p9} \mid \boldsymbol{\theta}_p\right) ) =  \mu_9 + \lambda_{91} \theta_{p1} \\
f(E\left(Y_{p,10} \mid \boldsymbol{\theta}_p\right) ) =  \mu_{10} + \lambda_{10,2} \theta_{p2} \\
\end{array}
\]</span></p>
</section>
<section id="our-example-multivariate-normal-distribution" class="slide level2">
<h2>Our Example: Multivariate Normal Distribution</h2>
<p>For our example, we will assume the set of traits follows a multivariate normal distribution</p>
<p><span class="math display">\[
f\left(\boldsymbol{\theta}_p \right) = \left(2 \pi \right)^{-\frac{D}{2}} \det\left(\boldsymbol{\Sigma}_\theta \right)^{-\frac{1}{2}}\exp\left[-\frac{1}{2}\left(\boldsymbol{\theta}_p - \boldsymbol{\mu}_\theta \right)^T\boldsymbol{\Sigma}_\theta^{-1}\left(\boldsymbol{\theta}_p - \boldsymbol{\mu}_\theta \right) \right]
\]</span> Where:</p>
<ul>
<li><span class="math inline">\(\pi \approx 3.14\)</span></li>
<li><span class="math inline">\(D\)</span> is the number of latent variables (dimensions)</li>
<li><span class="math inline">\(\boldsymbol{\Sigma}_\theta\)</span> is the covariance matrix of the latent variables
<ul>
<li><span class="math inline">\(\boldsymbol{\Sigma}_\theta^{-1}\)</span> is the inverse of the covariance matrix</li>
</ul></li>
<li><span class="math inline">\(\boldsymbol{\mu}_\theta\)</span> is the mean vector of the latent variables</li>
<li><span class="math inline">\(\det\left( \cdot\right)\)</span> is the matrix determinant function</li>
<li><span class="math inline">\(\left(\cdot \right)^T\)</span> is the matrix transpose operator</li>
</ul>
<p>Alternatively, we would specify <span class="math inline">\(\boldsymbol{\theta}_p \sim N_D\left( \boldsymbol{\mu}_\theta, \boldsymbol{\Sigma}_\theta \right)\)</span>; but, we cannot always estimate <span class="math inline">\(\boldsymbol{\mu}_\theta\)</span> and <span class="math inline">\(\boldsymbol{\Sigma}_\theta\)</span></p>
</section>
<section id="identification-of-latent-traits-part-1" class="slide level2">
<h2>Identification of Latent Traits, Part 1</h2>
<p>Psychometric models require two types of identification to be valid:</p>
<ol type="1">
<li>Empirical Identification</li>
</ol>
<ul>
<li>The minimum number of items that must measure each latent variable</li>
<li>From CFA: three observed variables for each latent variable (or two if the latent variable is correlated with another latent variable)</li>
</ul>
<p>Bayesian priors can help to make models with fewer items than these criteria suggest estimable</p>
<ul>
<li>The parameter estimates (item parameters and latent variable estimates) often have MCMC convergence issues and should not be trusted</li>
<li>Use the CFA standard in your work</li>
</ul>
</section>
<section id="identification-of-latent-traits-part-2" class="slide level2">
<h2>Identification of Latent Traits, Part 2</h2>
<p>Psychometric models require two types of identification to be valid:</p>
<ol start="2" type="1">
<li>Scale Identification (i.e., what the mean/variance is for each latent variable)</li>
</ol>
<ul>
<li>The additional set of constraints needed to set the mean and standard deviation (variance) of the latent variables</li>
<li>Two main methods to set the scale:
<ul>
<li>Marker item parameters
<ul>
<li>For variances: Set the loading/slope to one for one observed variable per latent variable
<ul>
<li>Can estimate the latent variable’s variance (the diagonal of <span class="math inline">\(\boldsymbol{\Sigma}_\theta\)</span>)</li>
</ul></li>
<li>For means: Set the item intercept to one for one observed variable perlatent variable
<ul>
<li>Can estimate the latent variable’s mean (in <span class="math inline">\(\boldsymbol{\mu}_\theta\)</span>)</li>
</ul></li>
</ul></li>
<li>Standardized factors
<ul>
<li>Set the variance for all latent variables to one</li>
<li>Set the mean for all latent variables to zero</li>
<li>Estimate all unique off-diagonal correlations (covariances) in <span class="math inline">\(\boldsymbol{\Sigma}_\theta\)</span></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="more-on-scale-identification" class="slide level2">
<h2>More on Scale Identification</h2>
<p>Bayesian priors can let you believe you can estimate more parameters than the non-Bayesian standards suggest</p>
<ul>
<li>For instance, all item parameters and the latent variable means/variances</li>
</ul>
<p>Like empirical identification, these estimates are often unstable and are not recommended</p>
<p>Most common:</p>
<ul>
<li>Standardized latent variables
<ul>
<li>Used for scale development and/or when scores are of interest directly</li>
</ul></li>
<li>Marker item for latent variables and zero means
<ul>
<li>Used for cases where latent variables may become outcomes (and that variance needs explained)</li>
</ul></li>
</ul>
<p>Today, we will use standardized factors</p>
<ul>
<li>Covariance matrix diagonal (factor variances) all ones
<ul>
<li>Modeling correlation matrix for factors</li>
</ul></li>
</ul>
</section>
<section id="observed-item-model" class="slide level2">
<h2>Observed Item Model</h2>
<p>For each item, we will use a graded- (ordinal logit) response modelwhere:</p>
<p><span class="math display">\[P\left(Y_{ic } = c \mid \theta_p \right) = \left\{
\begin{array}{lr}
1-P\left(Y_{i1} \gt 1 \mid \theta_p \right) &amp; \text{if } c=1 \\
P\left(Y_{i{c-1}} \gt c-1 \mid \theta_p \right) - P\left(Y_{i{c}} \gt c \mid \theta_p \right) &amp; \text{if } 1&lt;c&lt;C_i \\
P\left(Y_{i{C_i -1} } \gt C_i-1 \mid \theta_p \right) - 0 &amp; \text{if } c=C_i \\
\end{array} \right.\]</span></p>
<p>Where:</p>
<p><span class="math display">\[ P\left(Y_{i{c}} &gt; c \mid \theta \right) = \frac{\exp(\mu_{ic}+\lambda_i\theta_p)}{1+\exp(\mu_{ic}+\lambda_i\theta_p)}\]</span></p>
<p>With:</p>
<ul>
<li><span class="math inline">\(C_i-1\)</span> Ordered intercepts: <span class="math inline">\(\mu_1 &gt; \mu_2 &gt; \ldots &gt; \mu_{C_i-1}\)</span></li>
</ul>
</section>
<section id="section-1" class="slide level2" data-auto-animate="true," data-visibility="uncounted">
<h2 data-id="quarto-animate-title"></h2>
<div style="margin-top: 200px; font-size: 3em; color: red;">
<p>Building the Multidimensional Model in Stan</p>
</div>
</section>
<section id="observed-item-model-in-stan" class="slide level2">
<h2>Observed Item Model in Stan</h2>
<p>As Stan uses thresholds instead of intercepts, our model then becomes:</p>
<p><span class="math display">\[P\left(Y_{ic } = c \mid \theta_p \right) = \left\{
\begin{array}{lr}
1-P\left(Y_{i1} \gt 1 \mid \theta_p \right) &amp; \text{if } c=1 \\
P\left(Y_{i{c-1}} \gt c-1 \mid \theta_p \right) - P\left(Y_{i{c}} \gt c \mid \theta_p \right) &amp; \text{if } 1&lt;c&lt;C_i \\
P\left(Y_{i{C_i -1} } \gt C_i-1 \mid \theta_p \right) &amp; \text{if } c=C_i \\
\end{array} \right.\]</span></p>
<p>Where:</p>
<p><span class="math display">\[ P\left(Y_{i{c}} &gt; c \mid \theta \right) = \frac{\exp(-\tau_{ic}+\lambda_i\theta_p)}{1+\exp(-\tau_{ic}+\lambda_i\theta_p)}\]</span></p>
<p>With:</p>
<ul>
<li><span class="math inline">\(C_i-1\)</span> Ordered thresholds: <span class="math inline">\(\tau_1 &lt; \tau_2 &lt; \ldots &lt; \tau_{C_i-1}\)</span></li>
</ul>
<p>We can convert thresholds to intercepts by multiplying by negative one: <span class="math inline">\(\mu_c = -\tau_c\)</span></p>
</section>
<section id="stan-model-block" class="slide level2">
<h2>Stan Model Block</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>model {</span>
<span id="cb3-2"><a href="#cb3-2"></a>  </span>
<span id="cb3-3"><a href="#cb3-3"></a>  lambda <span class="sc">~</span> <span class="fu">multi_normal</span>(meanLambda, covLambda); </span>
<span id="cb3-4"><a href="#cb3-4"></a>  thetaCorrL <span class="sc">~</span> <span class="fu">lkj_corr_cholesky</span>(<span class="fl">1.0</span>);</span>
<span id="cb3-5"><a href="#cb3-5"></a>  theta <span class="sc">~</span> <span class="fu">multi_normal_cholesky</span>(meanTheta, thetaCorrL);    </span>
<span id="cb3-6"><a href="#cb3-6"></a>  </span>
<span id="cb3-7"><a href="#cb3-7"></a>  </span>
<span id="cb3-8"><a href="#cb3-8"></a>  <span class="cf">for</span> (item <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nItems){</span>
<span id="cb3-9"><a href="#cb3-9"></a>    thr[item] <span class="sc">~</span> <span class="fu">multi_normal</span>(meanThr[item], covThr[item]);            </span>
<span id="cb3-10"><a href="#cb3-10"></a>    Y[item] <span class="sc">~</span> <span class="fu">ordered_logistic</span>(thetaMatrix<span class="sc">*</span>lambdaMatrix[item,<span class="dv">1</span><span class="sc">:</span>nFactors]<span class="st">', thr[item]);</span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="st">  }</span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="st">  </span></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="st">  </span></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="st">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notes:</p>
<ul>
<li><code>thetaMatrix</code> is matrix of latent variables for each person <span class="math inline">\(\boldsymbol{\Theta}\)</span> (size <span class="math inline">\(N \times D\)</span>; <span class="math inline">\(N\)</span> is number of people, <span class="math inline">\(D\)</span> is number of dimensions)</li>
<li><code>lambdaMatrix</code> is, for each item, a matrix of factor loading/discrimination parameters along with zeros by Q-matrix (size <span class="math inline">\(I \times D\)</span>; <span class="math inline">\(I\)</span> is number of items)
<ul>
<li>The transpose of one row of the lambda matrix is used, resulting in a scalar for each person</li>
</ul></li>
<li><code>lambda</code> is a vector of estimated factor loadings (we use a different block to put these into <code>lambdaMatrix</code>)
<ul>
<li>Each factor loading has a (univariate) normal distribution for a prior</li>
</ul></li>
</ul>
</section>
<section id="more-model-block-notes" class="slide level2">
<h2>More Model Block Notes:</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>model {</span>
<span id="cb4-2"><a href="#cb4-2"></a>  </span>
<span id="cb4-3"><a href="#cb4-3"></a>  lambda <span class="sc">~</span> <span class="fu">multi_normal</span>(meanLambda, covLambda); </span>
<span id="cb4-4"><a href="#cb4-4"></a>  thetaCorrL <span class="sc">~</span> <span class="fu">lkj_corr_cholesky</span>(<span class="fl">1.0</span>);</span>
<span id="cb4-5"><a href="#cb4-5"></a>  theta <span class="sc">~</span> <span class="fu">multi_normal_cholesky</span>(meanTheta, thetaCorrL);    </span>
<span id="cb4-6"><a href="#cb4-6"></a>  </span>
<span id="cb4-7"><a href="#cb4-7"></a>  </span>
<span id="cb4-8"><a href="#cb4-8"></a>  <span class="cf">for</span> (item <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nItems){</span>
<span id="cb4-9"><a href="#cb4-9"></a>    thr[item] <span class="sc">~</span> <span class="fu">multi_normal</span>(meanThr[item], covThr[item]);            </span>
<span id="cb4-10"><a href="#cb4-10"></a>    Y[item] <span class="sc">~</span> <span class="fu">ordered_logistic</span>(thetaMatrix<span class="sc">*</span>lambdaMatrix[item,<span class="dv">1</span><span class="sc">:</span>nFactors]<span class="st">', thr[item]);</span></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="st">  }</span></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="st">  </span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="st">  </span></span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="st">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notes:</p>
<ul>
<li><code>theta</code> is an array of latent variables (we use a different block to put these into <code>thetaMatrix</code>)</li>
<li><code>theta</code> follows a multivariate normal distribution as a prior where:
<ul>
<li>We set all means of <code>theta</code> to zero (the mean for each factor is set to zero)</li>
<li>We set all variances of <code>theta</code> to one (the variance for each factor is set to one)</li>
<li>We estimate a correlation matrix of factors <span class="math inline">\(\textbf{R}_\theta\)</span> using a so-called LKJ prior distribution
<ul>
<li>LKJ priors are found in Stan and make modeling correlations very easy</li>
</ul></li>
</ul></li>
<li>Of note: we are using the Cholesky forms of the functions <code>lkj_corr_cholesky</code> and <code>multi_normal_cholesky</code></li>
</ul>
</section>
<section id="lkj-priors-for-correlation-matrices" class="slide level2">
<h2>LKJ Priors for Correlation Matrices</h2>
<p>From <a href="https://mc-stan.org/docs/functions-reference/lkj-correlation.html">Stan’s Functions Reference</a>, for a correlation matrix <span class="math inline">\(\textbf{R}_\theta\)</span></p>
<p>Correlation Matrix Properties:</p>
<ul>
<li>Positive definite (determinant greater than zero; <span class="math inline">\(\det\left(R_\theta \right) &gt;0\)</span></li>
<li>Symmetric</li>
<li>Diagonal values are all one</li>
</ul>
<p>LKJ Prior, with hyperparameter <span class="math inline">\(\eta\)</span>, is proportional to the determinant of the correlation matrix</p>
<p><span class="math display">\[\text{LKJ}\left(\textbf{R}_\theta \mid \eta \right) \propto \det\left(\textbf{R}_\theta \right)^{(\eta-1)} \]</span> Where:</p>
<ul>
<li>Density is uniform over correlation matrices with <span class="math inline">\(\eta=1\)</span></li>
<li>With <span class="math inline">\(\eta&gt;1\)</span>, identity matrix is modal (moves correlations toward zero)</li>
<li>With <span class="math inline">\(0&lt;\eta&lt;1\)</span>, density has a trough at the identity (moves correlations away from zero)</li>
</ul>
<p>For this example, we set <span class="math inline">\(\eta=1\)</span>, noting a uniform prior over all correlation matrices</p>
</section>
<section id="cholesky-decomposition" class="slide level2">
<h2>Cholesky Decomposition</h2>
<p>The functions we are using do not use the correlation matrix directly</p>
<h4 id="the-problem">The problem:</h4>
<ul>
<li>The issue: We need the inverse and determinant to calculate the density of a multivariate normal distribution
<ul>
<li>Inverses and determinants are numerically unstable (computationally) in general form</li>
</ul></li>
</ul>
<h4 id="the-solution">The solution:</h4>
<ul>
<li>Convert <span class="math inline">\(R_\theta\)</span> to a triangular form using the Cholesky decomposition</li>
</ul>
<p><span class="math display">\[\textbf{R}_\theta = \textbf{L}_\theta \textbf{L}_\theta^T\]</span></p>
</section>
<section id="cholesky-decomposition-math" class="slide level2">
<h2>Cholesky Decomposition Math</h2>
<ul>
<li><span class="math inline">\(\det\left(\textbf{R}_\theta \right) = \det\left(\textbf{L}_\theta \textbf{L}_\theta^T\right) = \det\left(\textbf{L}_\theta\right) \det\left(\textbf{L}_\theta^T\right) =  \det\left(\textbf{L}_\theta\right)^2 = \left(\prod_{d=1}^D l_{d,d}\right)^2\)</span> (note: product becomes sum for log-likelihood)</li>
<li>For the inverse, we work with the term in the exponent of the MVN pdf:</li>
</ul>
<p><span class="math display">\[-\frac{1}{2}\left(\boldsymbol{\theta}_p - \boldsymbol{\mu}_\theta \right)^T\textbf{R}_\theta^{-1}\left(\boldsymbol{\theta}_p - \boldsymbol{\mu}_\theta \right) =
-\frac{1}{2}\left(\boldsymbol{\theta}_p - \boldsymbol{\mu}_\theta \right)^T\left(\textbf{L}_\theta \textbf{L}_\theta^T\right)^{-1}\left(\boldsymbol{\theta}_p - \boldsymbol{\mu}_\theta \right) \]</span></p>
<p><span class="math display">\[ -\frac{1}{2}\left(\boldsymbol{\theta}_p - \boldsymbol{\mu}_\theta \right)^T\textbf{L}_\theta^{-T} \textbf{L}_\theta^{-1}\left(\boldsymbol{\theta}_p - \boldsymbol{\mu}_\theta \right)\]</span> Then, we solve by back substitution: <span class="math inline">\(\left(\boldsymbol{\theta}_p - \boldsymbol{\mu}_\theta \right)^T\textbf{L}_\theta^{-T}\)</span></p>
<ul>
<li>We can then multiply this result by itself to form the term in the exponent (times <span class="math inline">\(-\frac{1}{2}\)</span>)</li>
<li>Back substitution involves far fewer steps, minimizing the amount of rounding error in the process of forming the inverse</li>
</ul>
<p>Most algorithms using MVN distributions use some variant of this process (perhaps with a different factorization method such as QR)</p>
</section>
<section id="stan-parameters-block" class="slide level2">
<h2>Stan Parameters Block</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>parameters {</span>
<span id="cb5-2"><a href="#cb5-2"></a>  array[nObs] vector[nFactors] theta;                <span class="sc">/</span><span class="er">/</span> the latent <span class="fu">variables</span> (one <span class="cf">for</span> each person)</span>
<span id="cb5-3"><a href="#cb5-3"></a>  array[nItems] ordered[maxCategory<span class="dv">-1</span>] thr; <span class="sc">/</span><span class="er">/</span> the item <span class="fu">thresholds</span> (one <span class="cf">for</span> each item category minus one)</span>
<span id="cb5-4"><a href="#cb5-4"></a>  vector[nLoadings] lambda;             <span class="sc">/</span><span class="er">/</span> the factor loadings<span class="sc">/</span>item <span class="fu">discriminations</span> (one <span class="cf">for</span> each item)</span>
<span id="cb5-5"><a href="#cb5-5"></a>  cholesky_factor_corr[nFactors] thetaCorrL;</span>
<span id="cb5-6"><a href="#cb5-6"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notes:</p>
<ul>
<li><code>theta</code> is an array (for the MVN prior)</li>
<li><code>thr</code> is the same as the unidimensional model</li>
<li><code>lambda</code> is the vector of all factor loadings to be estimated (needs <code>nLoadings</code>)</li>
<li><code>thetaCorrL</code> is of type <code>cholesky_factor_corr</code>, a built in type that identifies this as the lower diagonal of a Cholesky-factorized correlation matrix</li>
</ul>
<p>We need a couple other blocks to link our parameters to the model</p>
</section>
<section id="stan-transformed-data-block" class="slide level2">
<h2>Stan Transformed Data Block</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>transformed data{</span>
<span id="cb6-2"><a href="#cb6-2"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> nLoadings <span class="ot">=</span> <span class="dv">0</span>;                                      <span class="sc">/</span><span class="er">/</span> number of loadings <span class="cf">in</span> model</span>
<span id="cb6-3"><a href="#cb6-3"></a>  </span>
<span id="cb6-4"><a href="#cb6-4"></a>  <span class="cf">for</span> (factor <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nFactors){</span>
<span id="cb6-5"><a href="#cb6-5"></a>    nLoadings <span class="ot">=</span> nLoadings <span class="sc">+</span> <span class="fu">sum</span>(Qmatrix[<span class="dv">1</span><span class="sc">:</span>nItems, factor]);</span>
<span id="cb6-6"><a href="#cb6-6"></a>  }</span>
<span id="cb6-7"><a href="#cb6-7"></a></span>
<span id="cb6-8"><a href="#cb6-8"></a>  array[nLoadings, <span class="dv">2</span>] int loadingLocation;                     <span class="sc">/</span><span class="er">/</span> the row<span class="sc">/</span>column positions of each loading</span>
<span id="cb6-9"><a href="#cb6-9"></a>  int loadingNum<span class="ot">=</span><span class="dv">1</span>;</span>
<span id="cb6-10"><a href="#cb6-10"></a>  </span>
<span id="cb6-11"><a href="#cb6-11"></a>  <span class="cf">for</span> (item <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nItems){</span>
<span id="cb6-12"><a href="#cb6-12"></a>    <span class="cf">for</span> (factor <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nFactors){</span>
<span id="cb6-13"><a href="#cb6-13"></a>      <span class="cf">if</span> (Qmatrix[item, factor] <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb6-14"><a href="#cb6-14"></a>        loadingLocation[loadingNum, <span class="dv">1</span>] <span class="ot">=</span> item;</span>
<span id="cb6-15"><a href="#cb6-15"></a>        loadingLocation[loadingNum, <span class="dv">2</span>] <span class="ot">=</span> factor;</span>
<span id="cb6-16"><a href="#cb6-16"></a>        loadingNum <span class="ot">=</span> loadingNum <span class="sc">+</span> <span class="dv">1</span>;</span>
<span id="cb6-17"><a href="#cb6-17"></a>      }</span>
<span id="cb6-18"><a href="#cb6-18"></a>    }</span>
<span id="cb6-19"><a href="#cb6-19"></a>  }</span>
<span id="cb6-20"><a href="#cb6-20"></a></span>
<span id="cb6-21"><a href="#cb6-21"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notes:</p>
<ul>
<li>The <code>transformed data {}</code> block runs prior to the Markov chain
<ul>
<li>We use it to create variables that will stay constant throughout the chain</li>
</ul></li>
<li>Here, we count the number of loadings in the Q-matrix <code>nLoadings</code>
<ul>
<li>We then process the Q-matrix to tell Stan the row and column position of each loading in the <code>loadingsMatrix</code> used in the <code>model {}</code> block
<ul>
<li>For instance, the loading for item one factor two has row position 1 and column position 2</li>
</ul></li>
</ul></li>
<li>This syntax works for any Q-matrix (but only has main effects in the model)</li>
</ul>
</section>
<section id="stan-transformed-parameters-block" class="slide level2">
<h2>Stan Transformed Parameters Block</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>transformed parameters{</span>
<span id="cb7-2"><a href="#cb7-2"></a>  matrix[nItems, nFactors] lambdaMatrix <span class="ot">=</span> <span class="fu">rep_matrix</span>(<span class="fl">0.0</span>, nItems, nFactors);</span>
<span id="cb7-3"><a href="#cb7-3"></a>  matrix[nObs, nFactors] thetaMatrix;</span>
<span id="cb7-4"><a href="#cb7-4"></a>  </span>
<span id="cb7-5"><a href="#cb7-5"></a>  <span class="sc">/</span><span class="er">/</span> build matrix <span class="cf">for</span> lambdas to multiply theta matrix</span>
<span id="cb7-6"><a href="#cb7-6"></a>  <span class="cf">for</span> (loading <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nLoadings){</span>
<span id="cb7-7"><a href="#cb7-7"></a>    lambdaMatrix[loadingLocation[loading,<span class="dv">1</span>], loadingLocation[loading,<span class="dv">2</span>]] <span class="ot">=</span> lambda[loading];</span>
<span id="cb7-8"><a href="#cb7-8"></a>  }</span>
<span id="cb7-9"><a href="#cb7-9"></a>  </span>
<span id="cb7-10"><a href="#cb7-10"></a>  <span class="cf">for</span> (factor <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nFactors){</span>
<span id="cb7-11"><a href="#cb7-11"></a>    thetaMatrix[,factor] <span class="ot">=</span> <span class="fu">to_vector</span>(theta[,factor]);</span>
<span id="cb7-12"><a href="#cb7-12"></a>  }</span>
<span id="cb7-13"><a href="#cb7-13"></a>  </span>
<span id="cb7-14"><a href="#cb7-14"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notes:</p>
<ul>
<li>The <code>transformed parameters {}</code> block runs prior to each iteration of the Markov chain
<ul>
<li>This means it affects the estimation of each type of parameter</li>
</ul></li>
<li>We use it to create:
<ul>
<li><code>thetaMatrix</code> (converting <code>theta</code> from an array to a matrix)</li>
<li><code>lambdaMatrix</code> (puts the loadings and zeros from the Q-matrix into correct position)
<ul>
<li><code>lambdaMatrix</code> initializes at zero (so we just have to add the loadings in the correct position)</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="stan-data-block" class="slide level2">
<h2>Stan Data Block</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>data {</span>
<span id="cb8-2"><a href="#cb8-2"></a>  </span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="sc">/</span><span class="er">/</span> data specifications  <span class="sc">==</span><span class="er">===========================================================</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> nObs;                            <span class="sc">/</span><span class="er">/</span> number of observations</span>
<span id="cb8-5"><a href="#cb8-5"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> nItems;                          <span class="sc">/</span><span class="er">/</span> number of items</span>
<span id="cb8-6"><a href="#cb8-6"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> maxCategory;       <span class="sc">/</span><span class="er">/</span> number of categories <span class="cf">for</span> each item</span>
<span id="cb8-7"><a href="#cb8-7"></a>  </span>
<span id="cb8-8"><a href="#cb8-8"></a>  <span class="sc">/</span><span class="er">/</span> input data  <span class="sc">==</span><span class="er">===========================================================</span></span>
<span id="cb8-9"><a href="#cb8-9"></a>  array[nItems, nObs] int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">1</span>, upper<span class="ot">=</span><span class="dv">5</span><span class="sc">&gt;</span>  Y; <span class="sc">/</span><span class="er">/</span> item responses <span class="cf">in</span> an array</span>
<span id="cb8-10"><a href="#cb8-10"></a></span>
<span id="cb8-11"><a href="#cb8-11"></a>  <span class="sc">/</span><span class="er">/</span> loading specifications  <span class="sc">==</span><span class="er">===========================================================</span></span>
<span id="cb8-12"><a href="#cb8-12"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">1</span><span class="sc">&gt;</span> nFactors;                                       <span class="sc">/</span><span class="er">/</span> number of loadings <span class="cf">in</span> the model</span>
<span id="cb8-13"><a href="#cb8-13"></a>  array[nItems, nFactors] int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span>, upper<span class="ot">=</span><span class="dv">1</span><span class="sc">&gt;</span> Qmatrix;</span>
<span id="cb8-14"><a href="#cb8-14"></a>  </span>
<span id="cb8-15"><a href="#cb8-15"></a>  <span class="sc">/</span><span class="er">/</span> prior specifications <span class="sc">==</span><span class="er">===========================================================</span></span>
<span id="cb8-16"><a href="#cb8-16"></a>  array[nItems] vector[maxCategory<span class="dv">-1</span>] meanThr;                <span class="sc">/</span><span class="er">/</span> prior mean vector <span class="cf">for</span> intercept parameters</span>
<span id="cb8-17"><a href="#cb8-17"></a>  array[nItems] matrix[maxCategory<span class="dv">-1</span>, maxCategory<span class="dv">-1</span>] covThr;  <span class="sc">/</span><span class="er">/</span> prior covariance matrix <span class="cf">for</span> intercept parameters</span>
<span id="cb8-18"><a href="#cb8-18"></a>  </span>
<span id="cb8-19"><a href="#cb8-19"></a>  vector[nItems] meanLambda;         <span class="sc">/</span><span class="er">/</span> prior mean vector <span class="cf">for</span> discrimination parameters</span>
<span id="cb8-20"><a href="#cb8-20"></a>  matrix[nItems, nItems] covLambda;  <span class="sc">/</span><span class="er">/</span> prior covariance matrix <span class="cf">for</span> discrimination parameters</span>
<span id="cb8-21"><a href="#cb8-21"></a>  </span>
<span id="cb8-22"><a href="#cb8-22"></a>  vector[nFactors] meanTheta;</span>
<span id="cb8-23"><a href="#cb8-23"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notes:</p>
<ul>
<li>Changes from unidimensional model:
<ul>
<li><code>meanTheta</code>: Factor means (hyperparameters) are added (but we will set these to zero)</li>
<li><code>nFactors</code>: Number of latent variables (needed for Q-matrix)</li>
<li><code>Qmatrix</code>: Q-matrix for model</li>
</ul></li>
</ul>
</section>
<section id="stan-generated-quantities-block" class="slide level2">
<h2>Stan Generated Quantities Block</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>generated quantities{ </span>
<span id="cb9-2"><a href="#cb9-2"></a>  array[nItems] vector[maxCategory<span class="dv">-1</span>] mu;</span>
<span id="cb9-3"><a href="#cb9-3"></a>  corr_matrix[nFactors] thetaCorr;</span>
<span id="cb9-4"><a href="#cb9-4"></a>   </span>
<span id="cb9-5"><a href="#cb9-5"></a>  <span class="cf">for</span> (item <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nItems){</span>
<span id="cb9-6"><a href="#cb9-6"></a>    mu[item] <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">*</span>thr[item];</span>
<span id="cb9-7"><a href="#cb9-7"></a>  }</span>
<span id="cb9-8"><a href="#cb9-8"></a>  </span>
<span id="cb9-9"><a href="#cb9-9"></a>  </span>
<span id="cb9-10"><a href="#cb9-10"></a>  thetaCorr <span class="ot">=</span> <span class="fu">multiply_lower_tri_self_transpose</span>(thetaCorrL);</span>
<span id="cb9-11"><a href="#cb9-11"></a>  </span>
<span id="cb9-12"><a href="#cb9-12"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notes:</p>
<ul>
<li>Converts thresholds to intercepts <code>mu</code></li>
<li>Creates <code>thetaCorr</code> by multiplying Cholesky-factorized lower triangle with upper triangle
<ul>
<li>We will only use the parameters of <code>thetaCorr</code> when looking at model output</li>
</ul></li>
</ul>
</section>
<section id="section-2" class="slide level2" data-auto-animate="true," data-visibility="uncounted">
<h2 data-id="quarto-animate-title"></h2>
<div style="margin-top: 200px; font-size: 3em; color: red;">
<p>Stan Analyses</p>
</div>
</section>
<section id="estimation-in-stan" class="slide level2">
<h2>Estimation in Stan</h2>
<p>We run stan the same way we have previously:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>modelOrderedLogit_samples <span class="ot">=</span> modelOrderedLogit_stan<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="at">data =</span> modelOrderedLogit_data,</span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="at">seed =</span> <span class="dv">191120221</span>,</span>
<span id="cb10-4"><a href="#cb10-4"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb10-5"><a href="#cb10-5"></a>  <span class="at">parallel_chains =</span> <span class="dv">4</span>,</span>
<span id="cb10-6"><a href="#cb10-6"></a>  <span class="at">iter_warmup =</span> <span class="dv">2000</span>,</span>
<span id="cb10-7"><a href="#cb10-7"></a>  <span class="at">iter_sampling =</span> <span class="dv">2000</span>,</span>
<span id="cb10-8"><a href="#cb10-8"></a>  <span class="at">init =</span> <span class="cf">function</span>() <span class="fu">list</span>(<span class="at">lambda=</span><span class="fu">rnorm</span>(nItems, <span class="at">mean=</span><span class="dv">5</span>, <span class="at">sd=</span><span class="dv">1</span>))</span>
<span id="cb10-9"><a href="#cb10-9"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notes:</p>
<ul>
<li>Smaller chain (model takes a lot longer to run)</li>
<li>Still need to keep loadings positive initially</li>
</ul>
</section>
<section id="analysis-results" class="slide level2">
<h2>Analysis Results</h2>
<div class="cell" data-hash="04e_Modeling_Multidimensional_Latent_Variables_cache/revealjs/unnamed-chunk-12_8643bbad17cd614a23f88ee6e6651476">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.080608</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 54 × 10
   varia…¹    mean  median      sd     mad       q5    q95  rhat ess_b…² ess_t…³
   &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
 1 lambda…  2.00    1.99   0.266   0.266     1.59    2.46   1.00  2608.   5005. 
 2 lambda…  2.84    2.82   0.382   0.378     2.25    3.50   1.00  2302.   4728. 
 3 lambda…  2.40    2.38   0.337   0.334     1.88    2.98   1.00  3336.   5197. 
 4 lambda…  2.93    2.91   0.397   0.388     2.31    3.62   1.00  3215.   5114. 
 5 lambda…  4.32    4.28   0.587   0.571     3.42    5.34   1.00  2727.   4328. 
 6 lambda…  4.21    4.19   0.571   0.572     3.33    5.20   1.00  2185.   4053. 
 7 lambda…  2.86    2.84   0.412   0.406     2.22    3.57   1.00  2515.   5597. 
 8 lambda…  4.13    4.09   0.561   0.556     3.28    5.11   1.00  2250.   4791. 
 9 lambda…  2.90    2.88   0.426   0.417     2.24    3.66   1.00  3152.   4106. 
10 lambda…  2.44    2.42   0.427   0.414     1.78    3.18   1.00  4581.   4975. 
11 mu[1,1]  1.87    1.86   0.289   0.293     1.41    2.36   1.00  1431.   3230. 
12 mu[2,1]  0.797   0.793  0.310   0.312     0.296   1.31   1.00   893.   1900. 
13 mu[3,1]  0.0833  0.0835 0.265   0.259    -0.356   0.516  1.00   765.   1468. 
14 mu[4,1]  0.983   0.977  0.329   0.327     0.454   1.53   1.00   860.   1584. 
15 mu[5,1]  1.29    1.28   0.434   0.425     0.601   2.03   1.01   637.   1407. 
16 mu[6,1]  0.945   0.934  0.426   0.414     0.283   1.65   1.01   589.   1248. 
17 mu[7,1] -0.124  -0.128  0.302   0.299    -0.615   0.376  1.00   717.   1116. 
18 mu[8,1]  0.670   0.659  0.407   0.401     0.0164  1.36   1.01   576.   1197. 
19 mu[9,1] -0.0781 -0.0805 0.309   0.305    -0.586   0.430  1.00   751.   1420. 
20 mu[10,… -1.37   -1.36   0.322   0.318    -1.92   -0.871  1.00  1074.   2160. 
21 mu[1,2] -0.222  -0.224  0.238   0.233    -0.617   0.167  1.00   992.   2111. 
22 mu[2,2] -1.54   -1.53   0.325   0.321    -2.09   -1.01   1.00   944.   1969. 
23 mu[3,2] -1.12   -1.12   0.278   0.280    -1.58   -0.666  1.00   819.   1839. 
24 mu[4,2] -1.16   -1.15   0.325   0.320    -1.70   -0.636  1.01   729.   1645. 
25 mu[5,2] -1.97   -1.96   0.452   0.448    -2.74   -1.24   1.00   735.   1352. 
26 mu[6,2] -2.02   -2.00   0.443   0.448    -2.75   -1.31   1.01   742.   1545. 
27 mu[7,2] -1.96   -1.95   0.349   0.349    -2.56   -1.41   1.00  1040.   1597. 
28 mu[8,2] -1.86   -1.84   0.429   0.431    -2.58   -1.16   1.01   691.   1230. 
29 mu[9,2] -1.96   -1.95   0.351   0.346    -2.56   -1.41   1.00  1038.   1978. 
30 mu[10,… -2.61   -2.60   0.380   0.378    -3.29   -2.02   1.00  1471.   3186. 
31 mu[1,3] -2.05   -2.04   0.284   0.279    -2.52   -1.59   1.00  1362.   2534. 
32 mu[2,3] -3.40   -3.39   0.416   0.414    -4.10   -2.74   1.00  1609.   3636. 
33 mu[3,3] -3.69   -3.67   0.424   0.418    -4.42   -3.04   1.00  1918.   5037. 
34 mu[4,3] -3.87   -3.85   0.472   0.458    -4.70   -3.12   1.00  1659.   3528. 
35 mu[5,3] -4.57   -4.55   0.607   0.597    -5.61   -3.63   1.00  1247.   3261. 
36 mu[6,3] -5.64   -5.62   0.684   0.684    -6.78   -4.55   1.00  2317.   4484. 
37 mu[7,3] -4.17   -4.14   0.505   0.506    -5.05   -3.39   1.00  2458.   4976. 
38 mu[8,3] -6.44   -6.40   0.784   0.779    -7.79   -5.22   1.00  3305.   5078. 
39 mu[9,3] -3.26   -3.24   0.430   0.430    -3.99   -2.59   1.00  1380.   3264. 
40 mu[10,… -3.78   -3.76   0.468   0.462    -4.57   -3.05   1.00  2149.   2306. 
41 mu[1,4] -3.99   -3.97   0.470   0.454    -4.80   -3.25   1.00  3417.   5173. 
42 mu[2,4] -4.93   -4.90   0.576   0.571    -5.91   -4.04   1.00  3034.   5066. 
43 mu[3,4] -4.79   -4.76   0.559   0.566    -5.74   -3.91   1.00  3136.   3794. 
44 mu[4,4] -4.78   -4.76   0.565   0.556    -5.78   -3.90   1.00  2148.   5506. 
45 mu[5,4] -6.83   -6.78   0.844   0.829    -8.28   -5.51   1.00  2528.   2677. 
46 mu[6,4] -7.96   -7.92   0.987   0.979    -9.62   -6.40   1.00  4736.   6305. 
47 mu[7,4] -5.72   -5.68   0.701   0.693    -6.97   -4.65   1.00  4510.   5613. 
48 mu[8,4] -8.49   -8.41   1.11    1.13    -10.4    -6.81   1.00  5309.   5788. 
49 mu[9,4] -4.96   -4.93   0.593   0.599    -5.97   -4.06   1.00  2448.   5618. 
50 mu[10,… -4.03   -4.01   0.495   0.491    -4.88   -3.26   1.00  2410.   2494. 
51 thetaC…  1       1      0       0         1       1     NA       NA      NA  
52 thetaC…  0.993   0.994  0.00632 0.00496   0.980   0.999  1.08    44.8    94.9
53 thetaC…  0.993   0.994  0.00632 0.00496   0.980   0.999  1.08    44.8    94.9
54 thetaC…  1       1      0       0         1       1     NA       NA      NA  
# … with abbreviated variable names ¹​variable, ²​ess_bulk, ³​ess_tail</code></pre>
</div>
</div>
<p>Note:</p>
<ul>
<li>EAP estimate of correlation was 0.993 – indicates only one factor in data</li>
</ul>
</section>
<section id="correlation-chains" class="slide level2">
<h2>Correlation Chains</h2>

<img data-src="04e_Modeling_Multidimensional_Latent_Variables_files/figure-revealjs/unnamed-chunk-13-1.png" width="960" class="r-stretch"></section>
<section id="correlation-posterior-distribution" class="slide level2">
<h2>Correlation Posterior Distribution</h2>

<img data-src="04e_Modeling_Multidimensional_Latent_Variables_files/figure-revealjs/unnamed-chunk-14-1.png" width="960" class="r-stretch"></section>
<section id="example-theta-posterior-distribution" class="slide level2">
<h2>Example Theta Posterior Distribution</h2>
<p>Plots of draws for person 1:</p>
<div class="cell" data-hash="04e_Modeling_Multidimensional_Latent_Variables_cache/revealjs/unnamed-chunk-15_a0ede2e4e231825bb94d110087dc08ca">

<div class="cell-output cell-output-stdout">
<pre><code>           theta[1,1] theta[1,2]
theta[1,1]  1.0000000  0.8629062
theta[1,2]  0.8629062  1.0000000</code></pre>
</div>
</div>
<img data-src="04e_Modeling_Multidimensional_Latent_Variables_files/figure-revealjs/unnamed-chunk-15-1.png" width="960" class="r-stretch"></section>
<section id="eap-theta-estimates" class="slide level2">
<h2>EAP Theta Estimates</h2>
<p>Plots of draws for person 1:</p>

<img data-src="04e_Modeling_Multidimensional_Latent_Variables_files/figure-revealjs/unnamed-chunk-16-1.png" width="960" class="r-stretch"></section>
<section id="section-3" class="slide level2" data-auto-animate="true," data-visibility="uncounted">
<h2 data-id="quarto-animate-title"></h2>
<div style="margin-top: 200px; font-size: 3em; color: red;">
<p>Wrapping Up</p>
</div>
</section>
<section id="wrapping-up" class="slide level2">
<h2>Wrapping Up</h2>
<p>Stan makes multidimensional latent variable models fairly easy to implement</p>
<ul>
<li>LKJ prior allows for scale identification with standardized factors</li>
<li>Can use my syntax and import any type of Q-matrix</li>
</ul>
<p>But…</p>
<ul>
<li>Estimation is slower (correlations take time)</li>
</ul>
<div class="footer footer-default">
<p><a href="https://jonathantemplin.com/bayesian-psychometric-modeling-fall-2022/">https://jonathantemplin.com/bayesian-psychometric-modeling-fall-2022/</a></p>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="04e_Modeling_Multidimensional_Latent_Variables_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="04e_Modeling_Multidimensional_Latent_Variables_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="04e_Modeling_Multidimensional_Latent_Variables_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="04e_Modeling_Multidimensional_Latent_Variables_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="04e_Modeling_Multidimensional_Latent_Variables_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="04e_Modeling_Multidimensional_Latent_Variables_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="04e_Modeling_Multidimensional_Latent_Variables_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="04e_Modeling_Multidimensional_Latent_Variables_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="04e_Modeling_Multidimensional_Latent_Variables_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="04e_Modeling_Multidimensional_Latent_Variables_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        function fireSlideChanged(previousSlide, currentSlide) {

          // dispatch for htmlwidgets
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for reveal
        if (window.Reveal) {
          window.Reveal.addEventListener("slidechanged", function(event) {
            fireSlideChanged(event.previousSlide, event.currentSlide);
          });
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        setTimeout(function() {
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const cites = ref.parentNode.getAttribute('data-cites').split(' ');
        tippyHover(ref, function() {
          var popup = window.document.createElement('div');
          cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    });
    </script>
    

</body></html>