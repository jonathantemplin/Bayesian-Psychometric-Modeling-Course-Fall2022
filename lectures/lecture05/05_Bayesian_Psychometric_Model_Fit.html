<!DOCTYPE html>
<html lang="en"><head>
<script src="05_Bayesian_Psychometric_Model_Fit_files/libs/clipboard/clipboard.min.js"></script>
<script src="05_Bayesian_Psychometric_Model_Fit_files/libs/quarto-html/tabby.min.js"></script>
<script src="05_Bayesian_Psychometric_Model_Fit_files/libs/quarto-html/popper.min.js"></script>
<script src="05_Bayesian_Psychometric_Model_Fit_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="05_Bayesian_Psychometric_Model_Fit_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="05_Bayesian_Psychometric_Model_Fit_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="05_Bayesian_Psychometric_Model_Fit_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.2.269">

  <meta name="author" content="Lecture 5">
  <title>Bayesian Psychometric Model Fit Methods</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="05_Bayesian_Psychometric_Model_Fit_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="05_Bayesian_Psychometric_Model_Fit_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="05_Bayesian_Psychometric_Model_Fit_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="05_Bayesian_Psychometric_Model_Fit_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="05_Bayesian_Psychometric_Model_Fit_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="05_Bayesian_Psychometric_Model_Fit_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="05_Bayesian_Psychometric_Model_Fit_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="05_Bayesian_Psychometric_Model_Fit_files/libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
  <script src="05_Bayesian_Psychometric_Model_Fit_files/libs/d3-4.5.0/d3.min.js"></script>
  <script src="05_Bayesian_Psychometric_Model_Fit_files/libs/forceNetwork-binding-0.4/forceNetwork.js"></script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Bayesian Psychometric Model Fit Methods</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Lecture 5 
</div>
</div>
</div>

</section>
<section id="todays-lecture-objectives" class="slide level2">
<h2>Today’s Lecture Objectives</h2>
<ol type="1">
<li>Show how to use PPMC to evaluate absolute model fit in Bayesian psychometric models</li>
<li>Show how to use LOO and WAIC for relative model fit in Bayesian psychometric models</li>
</ol>
</section>
<section id="example-data-conspiracy-theories" class="slide level2">
<h2>Example Data: Conspiracy Theories</h2>
<p>Today’s example is from a bootstrap resample of 177 undergraduate students at a large state university in the Midwest. The survey was a measure of 10 questions about their beliefs in various conspiracy theories that were being passed around the internet in the early 2010s. Additionally, gender was included in the survey. All items responses were on a 5- point Likert scale with:</p>
<ol type="1">
<li>Strongly Disagree</li>
<li>Disagree</li>
<li>Neither Agree or Disagree</li>
<li>Agree</li>
<li>Strongly Agree</li>
</ol>
<h4 id="please-note-the-purpose-of-this-survey-was-to-study-individual-beliefs-regarding-conspiracies.-the-questions-can-provoke-some-strong-emotions-given-the-world-we-live-in-currently.-all-questions-were-approved-by-university-irb-prior-to-their-use.">Please note, the purpose of this survey was to study individual beliefs regarding conspiracies. The questions can provoke some strong emotions given the world we live in currently. All questions were approved by university IRB prior to their use.</h4>
<p>Our purpose in using this instrument is to provide a context that we all may find relevant as many of these conspiracy theories are still prevalent today.</p>
</section>
<section id="conspiracy-theory-questions-1-5" class="slide level2">
<h2>Conspiracy Theory Questions 1-5</h2>
<p>Questions:</p>
<ol type="1">
<li>The U.S. invasion of Iraq was not part of a campaign to fight terrorism, but was driven by oil companies and Jews in the U.S. and Israel.</li>
<li>Certain U.S. government officials planned the attacks of September 11, 2001 because they wanted the United States to go to war in the Middle East.</li>
<li>President Barack Obama was not really born in the United States and does not have an authentic Hawaiian birth certificate.</li>
<li>The current financial crisis was secretly orchestrated by a small group of Wall Street bankers to extend the power of the Federal Reserve and further their control of the world’s economy.</li>
<li>Vapor trails left by aircraft are actually chemical agents deliberately sprayed in a clandestine program directed by government officials.</li>
</ol>
</section>
<section id="conspiracy-theory-questions-6-10" class="slide level2">
<h2>Conspiracy Theory Questions 6-10</h2>
<p>Questions:</p>
<ol start="6" type="1">
<li>Billionaire George Soros is behind a hidden plot to destabilize the American government, take control of the media, and put the world under his control.</li>
<li>The U.S. government is mandating the switch to compact fluorescent light bulbs because such lights make people more obedient and easier to control.</li>
<li>Government officials are covertly Building a 12-lane "NAFTA superhighway" that runs from Mexico to Canada through America’s heartland.</li>
<li>Government officials purposely developed and spread drugs like crack-cocaine and diseases like AIDS in order to destroy the African American community.</li>
<li>God sent Hurricane Katrina to punish America for its sins.</li>
</ol>
</section>
<section id="model-setup-today" class="slide level2">
<h2>Model Setup Today</h2>
<p>Today, we will revert back to the graded response model assumptions to discuss how to estimate the latent variable standard deviation</p>
<p><span class="math display">\[P\left(Y_{ic } = c \mid \theta_p \right) = \left\{
\begin{array}{lr}
1-P\left(Y_{i1} \gt 1 \mid \theta_p \right) &amp; \text{if } c=1 \\
P\left(Y_{i{c-1}} \gt c-1 \mid \theta_p \right) - P\left(Y_{i{c}} \gt c \mid \theta_p \right) &amp; \text{if } 1&lt;c&lt;C_i \\
P\left(Y_{i{C_i -1} } \gt C_i-1 \mid \theta_p \right) &amp; \text{if } c=C_i \\
\end{array} \right.\]</span></p>
<p>Where:</p>
<p><span class="math display">\[ P\left(Y_{i{c}} &gt; c \mid \theta \right) = \frac{\exp(-\tau_{ic}+\lambda_i\theta_p)}{1+\exp(-\tau_{ic}+\lambda_i\theta_p)}\]</span></p>
<p>With:</p>
<ul>
<li><span class="math inline">\(C_i-1\)</span> Ordered thresholds: <span class="math inline">\(\tau_1 &lt; \tau_2 &lt; \ldots &lt; \tau_{C_i-1}\)</span></li>
</ul>
<p>We can convert thresholds to intercepts by multiplying by negative one: <span class="math inline">\(\mu_c = -\tau_c\)</span></p>
</section>
<section id="model-comparisons-one-vs.-two-dimensions" class="slide level2">
<h2>Model Comparisons: One vs.&nbsp;Two Dimensions</h2>
<p>We will fit two models to the data:</p>
<ol type="1">
<li>A unidimensional model <a href="https://jonathantemplin.github.io/Bayesian-Psychometric-Modeling-Course-Fall2022/lectures/lecture04d/04d_Modeling_Observed_Polytomous_Data#/title-slide">(see Lecture 4d here)</a></li>
<li>A two-dimensionsal model <a href="https://jonathantemplin.github.io/Bayesian-Psychometric-Modeling-Course-Fall2022/lectures/lecture04e/04e_Modeling_Multidimensional_Latent_Variables#/title-slide">(see Lecture 4e here)</a></li>
</ol>
<p>We know from previous lectures that the two-dimensional model had a correlation very close to one</p>
<ul>
<li>Such a high correlation made it seem implausible there were two dimensions</li>
</ul>
</section>
<section id="section" class="slide level2" data-auto-animate="true," data-visibility="uncounted">
<h2 data-id="quarto-animate-title"></h2>
<div style="margin-top: 200px; font-size: 3em; color: red;">
<p>Posterior Predictive Model Checking for Absolute Fit in Bayesian Psychometric Models</p>
</div>
</section>
<section id="psychometric-model-ppmc" class="slide level2">
<h2>Psychometric Model PPMC</h2>
<p>Psychometric models can use posterior predictive model checking (PPMC) to assess how well they fit the data in an absolute sense</p>
<ul>
<li>Each iteration of the chain, each item is simulated using model parameter values from that iteration</li>
<li>Summary statistics are used to evaluate model fit
<ul>
<li>Univariate measures (each item, separately):
<ul>
<li>Item mean</li>
<li>Item <span class="math inline">\(\chi^2\)</span> (comparing observed data with each simulated data set)</li>
</ul></li>
<li>Not very useful unless:
<ul>
<li>Parameters have “obscenely” informative priors</li>
<li>There are cross-item constraints on some parameters (such as all loadings are equal)</li>
</ul></li>
<li>Bivariate measures (each pair of items)
<ul>
<li>For binary data: Tetrachoric correlations</li>
<li>For polytomous data: Polychoric correlations (but difficult to estimate with small samples), pearson correlations</li>
<li>For other types of data: Pearson correlations</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="problems-with-ppmc" class="slide level2">
<h2>Problems with PPMC</h2>
<p>Problems with PPMC include</p>
<ul>
<li>No uniform standard for which statistics to use
<ul>
<li>Tetrachoric correlations? Pearson correlations?</li>
</ul></li>
<li>No uniform standard by which data should fit, absolutely
<ul>
<li>Jihong Zhang has some work on this topic, though:
<ul>
<li>Paper in <a href="https://www.tandfonline.com/doi/abs/10.1080/10705511.2021.2012682"><em>Structural Equation Modeling</em></a></li>
<li>Dissertation on PPMC with M2 statistics (working on publishing)</li>
</ul></li>
</ul></li>
<li>No way to determine if a model is overparameterized (too complicated)
<ul>
<li>Fit only improves to a limit</li>
</ul></li>
</ul>
</section>
<section id="implementing-ppmc-in-stan-one-theta" class="slide level2">
<h2>Implementing PPMC in Stan (one <span class="math inline">\(\theta\)</span>)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>generated quantities{</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a>  <span class="sc">/</span><span class="er">/</span> <span class="cf">for</span> PPMC<span class="sc">:</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>  array[nItems, nObs] int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> simY;</span>
<span id="cb1-5"><a href="#cb1-5"></a>  </span>
<span id="cb1-6"><a href="#cb1-6"></a>  <span class="cf">for</span> (item <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nItems){</span>
<span id="cb1-7"><a href="#cb1-7"></a>    <span class="cf">for</span> (obs <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nObs){</span>
<span id="cb1-8"><a href="#cb1-8"></a>      <span class="sc">/</span><span class="er">/</span> generate data based on distribution and model</span>
<span id="cb1-9"><a href="#cb1-9"></a>      simY[item, obs] <span class="ot">=</span> <span class="fu">ordered_logistic_rng</span>(lambda[item]<span class="sc">*</span>theta[obs], thr[item]);</span>
<span id="cb1-10"><a href="#cb1-10"></a>      </span>
<span id="cb1-11"><a href="#cb1-11"></a>    }</span>
<span id="cb1-12"><a href="#cb1-12"></a>  }</span>
<span id="cb1-13"><a href="#cb1-13"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notes:</p>
<ul>
<li>Generated quantities block is where to implement PPMC</li>
<li>Each type of distribution also has a random number generator
<ul>
<li>Here, <code>ordered_logistic_rng</code> goes with <code>ordered_logistic</code></li>
</ul></li>
<li>Each may have some issue in types of inputs (had to go person-by-person in this block)</li>
<li>Rather than have Stan calculate statistics, I will do so in R</li>
</ul>
</section>
<section id="implementing-ppmc-in-stan-two-thetas" class="slide level2">
<h2>Implementing PPMC in Stan (two <span class="math inline">\(\theta\)</span>s)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>generated quantities{ </span>
<span id="cb2-2"><a href="#cb2-2"></a>  <span class="sc">/</span><span class="er">/</span> <span class="cf">for</span> PPMC<span class="sc">:</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>  array[nItems, nObs] int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> simY;</span>
<span id="cb2-4"><a href="#cb2-4"></a></span>
<span id="cb2-5"><a href="#cb2-5"></a>  <span class="cf">for</span> (item <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nItems){</span>
<span id="cb2-6"><a href="#cb2-6"></a>    <span class="cf">for</span> (obs <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nObs){</span>
<span id="cb2-7"><a href="#cb2-7"></a>      <span class="sc">/</span><span class="er">/</span> generate data based on distribution and model</span>
<span id="cb2-8"><a href="#cb2-8"></a>      simY[item, obs] <span class="ot">=</span> <span class="fu">ordered_logistic_rng</span>(thetaMatrix[obs,]<span class="sc">*</span>lambdaMatrix[item,<span class="dv">1</span><span class="sc">:</span>nFactors]<span class="st">', thr[item]);</span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="st">      </span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="st">    }</span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="st">  }  </span></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="st">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notes:</p>
<ul>
<li>Very similar to one dimension–just using the syntax from the model block within the <code>ordered_logistic_rng</code> function</li>
</ul>
</section>
<section id="ppmc-processing" class="slide level2">
<h2>PPMC Processing</h2>
<p>Stan generated a lot of data–but now we must take it from the format of Stan and process it:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># setting up PPMC</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>simData <span class="ot">=</span> modelOrderedLogit_samples<span class="sc">$</span><span class="fu">draws</span>(<span class="at">variables =</span> <span class="st">"simY"</span>, <span class="at">format =</span> <span class="st">"draws_matrix"</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="fu">colnames</span>(simData)</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="fu">dim</span>(simData)</span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co"># set up object for storing each iteration's PPMC data</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>nPairs <span class="ot">=</span> <span class="fu">choose</span>(<span class="dv">10</span>, <span class="dv">2</span>)</span>
<span id="cb3-9"><a href="#cb3-9"></a>pairNames <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="cf">for</span> (col <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(nItems<span class="dv">-1</span>)){</span>
<span id="cb3-11"><a href="#cb3-11"></a>  <span class="cf">for</span> (row <span class="cf">in</span> (col<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>nItems){</span>
<span id="cb3-12"><a href="#cb3-12"></a>    pairNames <span class="ot">=</span> <span class="fu">c</span>(pairNames, <span class="fu">paste0</span>(<span class="st">"item"</span>, row, <span class="st">"_item"</span>, col))</span>
<span id="cb3-13"><a href="#cb3-13"></a>  }</span>
<span id="cb3-14"><a href="#cb3-14"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ppmc-calculating-in-r" class="slide level2">
<h2>PPMC Calculating in R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>PPMCsamples <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a>PPMCsamples<span class="sc">$</span>correlation <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>PPMCsamples<span class="sc">$</span>mean <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co"># loop over each posterior sample's simulated data</span></span>
<span id="cb4-7"><a href="#cb4-7"></a></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="cf">for</span> (sample <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(simData)){</span>
<span id="cb4-9"><a href="#cb4-9"></a>  </span>
<span id="cb4-10"><a href="#cb4-10"></a>  <span class="co"># create data frame that has observations (rows) by items (columns)</span></span>
<span id="cb4-11"><a href="#cb4-11"></a>  sampleData <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">data =</span> <span class="cn">NA</span>, <span class="at">nrow =</span> nObs, <span class="at">ncol =</span> nItems))</span>
<span id="cb4-12"><a href="#cb4-12"></a>  </span>
<span id="cb4-13"><a href="#cb4-13"></a>  <span class="cf">for</span> (item <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nItems){</span>
<span id="cb4-14"><a href="#cb4-14"></a>    itemColumns <span class="ot">=</span> <span class="fu">colnames</span>(simData)[<span class="fu">grep</span>(<span class="at">pattern =</span> <span class="fu">paste0</span>(<span class="st">"simY</span><span class="sc">\\</span><span class="st">["</span>, item, <span class="st">"</span><span class="sc">\\</span><span class="st">,"</span>), <span class="at">x =</span> <span class="fu">colnames</span>(simData))] </span>
<span id="cb4-15"><a href="#cb4-15"></a>    sampleData[,item] <span class="ot">=</span> <span class="fu">t</span>(simData[sample, itemColumns])</span>
<span id="cb4-16"><a href="#cb4-16"></a>  }</span>
<span id="cb4-17"><a href="#cb4-17"></a>  <span class="co"># with data frame created, apply functions of the data:</span></span>
<span id="cb4-18"><a href="#cb4-18"></a>  </span>
<span id="cb4-19"><a href="#cb4-19"></a>  <span class="co"># calculate item means</span></span>
<span id="cb4-20"><a href="#cb4-20"></a>  PPMCsamples<span class="sc">$</span>mean <span class="ot">=</span> <span class="fu">rbind</span>(PPMCsamples<span class="sc">$</span>mean, <span class="fu">apply</span>(<span class="at">X =</span> sampleData, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean))</span>
<span id="cb4-21"><a href="#cb4-21"></a>  </span>
<span id="cb4-22"><a href="#cb4-22"></a>  <span class="co"># calculate pearson correlations  </span></span>
<span id="cb4-23"><a href="#cb4-23"></a>  temp<span class="ot">=</span><span class="fu">cor</span>(sampleData)</span>
<span id="cb4-24"><a href="#cb4-24"></a>  PPMCsamples<span class="sc">$</span>correlation <span class="ot">=</span> <span class="fu">rbind</span>(PPMCsamples<span class="sc">$</span>correlation, temp[<span class="fu">lower.tri</span>(temp)])</span>
<span id="cb4-25"><a href="#cb4-25"></a>  </span>
<span id="cb4-26"><a href="#cb4-26"></a>  </span>
<span id="cb4-27"><a href="#cb4-27"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ppmc-results-tabulation-in-r-mean" class="slide level2">
<h2>PPMC Results Tabulation in R (Mean)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># next, build distributions for each type of statistic</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>meanSummary <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb5-3"><a href="#cb5-3"></a></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co"># for means</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="cf">for</span> (item <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nItems){</span>
<span id="cb5-6"><a href="#cb5-6"></a>  </span>
<span id="cb5-7"><a href="#cb5-7"></a>  tempDist <span class="ot">=</span> <span class="fu">ecdf</span>(PPMCsamples<span class="sc">$</span>mean[,item])</span>
<span id="cb5-8"><a href="#cb5-8"></a>  ppmcMean <span class="ot">=</span> <span class="fu">mean</span>(PPMCsamples<span class="sc">$</span>mean[,item])</span>
<span id="cb5-9"><a href="#cb5-9"></a>  observedMean <span class="ot">=</span> <span class="fu">mean</span>(conspiracyItems[,item])</span>
<span id="cb5-10"><a href="#cb5-10"></a>  meanSummary <span class="ot">=</span> <span class="fu">rbind</span>(</span>
<span id="cb5-11"><a href="#cb5-11"></a>    meanSummary,</span>
<span id="cb5-12"><a href="#cb5-12"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb5-13"><a href="#cb5-13"></a>      <span class="at">item =</span> <span class="fu">paste0</span>(<span class="st">"Item"</span>, item),</span>
<span id="cb5-14"><a href="#cb5-14"></a>      <span class="at">ppmcMean =</span> ppmcMean,</span>
<span id="cb5-15"><a href="#cb5-15"></a>      <span class="at">observedMean =</span> observedMean,</span>
<span id="cb5-16"><a href="#cb5-16"></a>      <span class="at">residual =</span> observedMean <span class="sc">-</span> ppmcMean,</span>
<span id="cb5-17"><a href="#cb5-17"></a>      <span class="at">observedMeanPCT =</span> <span class="fu">tempDist</span>(observedMean)</span>
<span id="cb5-18"><a href="#cb5-18"></a>    )</span>
<span id="cb5-19"><a href="#cb5-19"></a>  )</span>
<span id="cb5-20"><a href="#cb5-20"></a>  </span>
<span id="cb5-21"><a href="#cb5-21"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ppmc-results-tabulation-in-r-correlation" class="slide level2">
<h2>PPMC Results Tabulation in R (Correlation)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># for pearson correlations</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>corrSummary <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb6-3"><a href="#cb6-3"></a></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co"># for means</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="cf">for</span> (column <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(PPMCsamples<span class="sc">$</span>correlation)){</span>
<span id="cb6-6"><a href="#cb6-6"></a>  </span>
<span id="cb6-7"><a href="#cb6-7"></a>  <span class="co"># get item numbers from items</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>  items <span class="ot">=</span> <span class="fu">unlist</span>(<span class="fu">strsplit</span>(<span class="at">x =</span> <span class="fu">colnames</span>(PPMCsamples<span class="sc">$</span>correlation)[column], <span class="at">split =</span> <span class="st">"_"</span>))</span>
<span id="cb6-9"><a href="#cb6-9"></a>  item1num <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(<span class="at">x =</span> items[<span class="dv">1</span>], <span class="at">start =</span> <span class="dv">5</span>, <span class="at">stop =</span> <span class="fu">nchar</span>(items[<span class="dv">1</span>])))</span>
<span id="cb6-10"><a href="#cb6-10"></a>  item2num <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(<span class="at">x =</span> items[<span class="dv">2</span>], <span class="at">start =</span> <span class="dv">5</span>, <span class="at">stop =</span> <span class="fu">nchar</span>(items[<span class="dv">2</span>])))</span>
<span id="cb6-11"><a href="#cb6-11"></a>  </span>
<span id="cb6-12"><a href="#cb6-12"></a>  tempDist <span class="ot">=</span> <span class="fu">ecdf</span>(PPMCsamples<span class="sc">$</span>correlation[,column])</span>
<span id="cb6-13"><a href="#cb6-13"></a>  ppmcCorr <span class="ot">=</span> <span class="fu">mean</span>(PPMCsamples<span class="sc">$</span>correlation[,column])</span>
<span id="cb6-14"><a href="#cb6-14"></a>  observedCorr <span class="ot">=</span> <span class="fu">cor</span>(conspiracyItems[,<span class="fu">c</span>(item1num, item2num)])[<span class="dv">1</span>,<span class="dv">2</span>]</span>
<span id="cb6-15"><a href="#cb6-15"></a>  pct <span class="ot">=</span> <span class="fu">tempDist</span>(observedCorr)</span>
<span id="cb6-16"><a href="#cb6-16"></a>  <span class="cf">if</span> (pct <span class="sc">&gt;</span> .<span class="dv">975</span> <span class="sc">|</span> pct <span class="sc">&lt;</span> .<span class="dv">025</span>){</span>
<span id="cb6-17"><a href="#cb6-17"></a>    inTail <span class="ot">=</span> <span class="cn">TRUE</span></span>
<span id="cb6-18"><a href="#cb6-18"></a>  } <span class="cf">else</span> {</span>
<span id="cb6-19"><a href="#cb6-19"></a>    inTail <span class="ot">=</span> <span class="cn">FALSE</span></span>
<span id="cb6-20"><a href="#cb6-20"></a>  }</span>
<span id="cb6-21"><a href="#cb6-21"></a>  corrSummary <span class="ot">=</span> <span class="fu">rbind</span>(</span>
<span id="cb6-22"><a href="#cb6-22"></a>    corrSummary,</span>
<span id="cb6-23"><a href="#cb6-23"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb6-24"><a href="#cb6-24"></a>      <span class="at">item1 =</span> <span class="fu">paste0</span>(<span class="st">"Item"</span>, item1num),</span>
<span id="cb6-25"><a href="#cb6-25"></a>      <span class="at">item2 =</span> <span class="fu">paste0</span>(<span class="st">"Item"</span>, item2num),</span>
<span id="cb6-26"><a href="#cb6-26"></a>      <span class="at">ppmcCorr =</span> ppmcCorr,</span>
<span id="cb6-27"><a href="#cb6-27"></a>      <span class="at">observedCorr =</span> observedCorr,</span>
<span id="cb6-28"><a href="#cb6-28"></a>      <span class="at">residual =</span> observedCorr <span class="sc">-</span> ppmcCorr,</span>
<span id="cb6-29"><a href="#cb6-29"></a>      <span class="at">observedCorrPCT =</span> pct, </span>
<span id="cb6-30"><a href="#cb6-30"></a>      <span class="at">inTail =</span> inTail</span>
<span id="cb6-31"><a href="#cb6-31"></a>    )</span>
<span id="cb6-32"><a href="#cb6-32"></a>  )</span>
<span id="cb6-33"><a href="#cb6-33"></a>  </span>
<span id="cb6-34"><a href="#cb6-34"></a>}</span>
<span id="cb6-35"><a href="#cb6-35"></a></span>
<span id="cb6-36"><a href="#cb6-36"></a><span class="fu">View</span>(corrSummary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ppmc-mean-results-example-item-one-theta" class="slide level2">
<h2>PPMC Mean Results: Example Item (One <span class="math inline">\(\theta\)</span>)</h2>

<img data-src="05_Bayesian_Psychometric_Model_Fit_files/figure-revealjs/unnamed-chunk-8-1.png" width="960" class="r-stretch"></section>
<section id="ppmc-mean-results-example-item-two-thetas" class="slide level2">
<h2>PPMC Mean Results: Example Item (Two <span class="math inline">\(\theta\)</span>s)</h2>

<img data-src="05_Bayesian_Psychometric_Model_Fit_files/figure-revealjs/unnamed-chunk-9-1.png" width="960" class="r-stretch"></section>
<section id="ppmc-mean-results" class="slide level2">
<h2>PPMC Mean Results</h2>
<p>One <span class="math inline">\(\theta\)</span></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>     item ppmcMean observedMean     residual observedMeanPCT
1   Item1 2.352560     2.367232  0.014671186         0.58340
2   Item2 1.958342     1.954802 -0.003539831         0.47495
3   Item3 1.862719     1.875706  0.012987571         0.58610
4   Item4 2.008068     2.011299  0.003231638         0.53915
5   Item5 1.978207     1.983051  0.004843503         0.53005
6   Item6 1.880974     1.892655  0.011681356         0.61725
7   Item7 1.748335     1.723164 -0.025171469         0.37290
8   Item8 1.840580     1.841808  0.001228249         0.51550
9   Item9 1.825317     1.807910 -0.017407062         0.43230
10 Item10 1.535198     1.519774 -0.015424294         0.45225</code></pre>
</div>
</div>
<p>Two <span class="math inline">\(\theta\)</span>s</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>     item ppmcMean observedMean      residual observedMeanPCT
1   Item1 2.357626     2.367232  0.0096059322        0.559500
2   Item2 1.969614     1.954802 -0.0148114407        0.418500
3   Item3 1.874785     1.875706  0.0009216102        0.528000
4   Item4 2.016655     2.011299 -0.0053552260        0.493000
5   Item5 1.988220     1.983051 -0.0051687853        0.465375
6   Item6 1.895842     1.892655 -0.0031864407        0.500375
7   Item7 1.758951     1.723164 -0.0357874294        0.326125
8   Item8 1.853244     1.841808 -0.0114357345        0.424500
9   Item9 1.835992     1.807910 -0.0280819209        0.373625
10 Item10 1.553063     1.519774 -0.0332888418        0.376125</code></pre>
</div>
</div>
</section>
<section id="ppmc-correlation-results-example-item-pair-one-theta" class="slide level2">
<h2>PPMC Correlation Results: Example Item Pair (One <span class="math inline">\(\theta\)</span>)</h2>

<img data-src="05_Bayesian_Psychometric_Model_Fit_files/figure-revealjs/unnamed-chunk-12-1.png" width="960" class="r-stretch"></section>
<section id="ppmc-correlation-results-example-item-pair-two-thetas" class="slide level2">
<h2>PPMC Correlation Results: Example Item Pair (Two <span class="math inline">\(\theta\)</span>s)</h2>

<img data-src="05_Bayesian_Psychometric_Model_Fit_files/figure-revealjs/unnamed-chunk-13-1.png" width="960" class="r-stretch"></section>
<section id="ppmc-correlation-results" class="slide level2">
<h2>PPMC Correlation Results</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>    item1 item2 observedCorr ppmcCorr.x   residual.x observedCorrPCT.x inTail.x
1  Item10 Item1    0.2568334  0.4131131 -0.156279686           0.01655     TRUE
2  Item10 Item2    0.4121264  0.4917030 -0.079576626           0.14375    FALSE
3  Item10 Item3    0.5670156  0.4522000  0.114815615           0.93835    FALSE
4  Item10 Item4    0.4516124  0.4890239 -0.037411565           0.28790    FALSE
5  Item10 Item5    0.5822203  0.5567640  0.025456304           0.62005    FALSE
6  Item10 Item6    0.5092003  0.5501939 -0.040993565           0.25890    FALSE
7  Item10 Item7    0.4420205  0.4992130 -0.057192487           0.22315    FALSE
8  Item10 Item8    0.5457127  0.5434373  0.002275470           0.48760    FALSE
9  Item10 Item9    0.4244916  0.4940797 -0.069588089           0.18525    FALSE
10  Item2 Item1    0.6024186  0.5357365  0.066682114           0.85585    FALSE
11  Item3 Item1    0.3473072  0.4931202 -0.145812943           0.01745     TRUE
12  Item3 Item2    0.5176819  0.5569093 -0.039227387           0.26420    FALSE
13  Item4 Item1    0.5700901  0.5439901  0.026099947           0.64290    FALSE
14  Item4 Item2    0.5815808  0.6090530 -0.027472228           0.30375    FALSE
15  Item4 Item3    0.4973987  0.5615192 -0.064120482           0.15380    FALSE
16  Item5 Item1    0.5526073  0.6008370 -0.048229709           0.19820    FALSE
17  Item5 Item2    0.6512768  0.6835423 -0.032265485           0.25645    FALSE
18  Item5 Item3    0.5942163  0.6288536 -0.034637387           0.26495    FALSE
19  Item5 Item4    0.6267160  0.6877014 -0.060985378           0.11495    FALSE
20  Item6 Item1    0.5435771  0.5996223 -0.056045208           0.16460    FALSE
21  Item6 Item2    0.6835282  0.6802492  0.003279028           0.49990    FALSE
22  Item6 Item3    0.6601292  0.6276426  0.032486611           0.68855    FALSE
23  Item6 Item4    0.6251455  0.6853371 -0.060191526           0.11720    FALSE
24  Item6 Item5    0.7366890  0.7696183 -0.032929309           0.18445    FALSE
25  Item7 Item1    0.4084389  0.5196236 -0.111184764           0.04695    FALSE
26  Item7 Item2    0.4721628  0.5988845 -0.126721659           0.02785    FALSE
27  Item7 Item3    0.6193269  0.5520486  0.067278349           0.83690    FALSE
28  Item7 Item4    0.4676834  0.6002957 -0.132612336           0.02010     TRUE
29  Item7 Item5    0.6204485  0.6779012 -0.057452711           0.14370    FALSE
30  Item7 Item6    0.6870303  0.6740562  0.012974158           0.57020    FALSE
31  Item8 Item1    0.5425166  0.5990322 -0.056515657           0.16485    FALSE
32  Item8 Item2    0.6317705  0.6774062 -0.045635698           0.17995    FALSE
33  Item8 Item3    0.6182736  0.6266373 -0.008363667           0.42020    FALSE
34  Item8 Item4    0.6373299  0.6835823 -0.046252488           0.17135    FALSE
35  Item8 Item5    0.7641703  0.7672351 -0.003064875           0.44260    FALSE
36  Item8 Item6    0.7557355  0.7697220 -0.013986520           0.33825    FALSE
37  Item8 Item7    0.6611475  0.6720005 -0.010853042           0.39345    FALSE
38  Item9 Item1    0.4420860  0.5114050 -0.069318985           0.14180    FALSE
39  Item9 Item2    0.5998366  0.5909206  0.008915976           0.53460    FALSE
40  Item9 Item3    0.3912734  0.5436816 -0.152408206           0.01670     TRUE
41  Item9 Item4    0.6108052  0.5917868  0.019018393           0.60460    FALSE
42  Item9 Item5    0.7119365  0.6693743  0.042562230           0.76780    FALSE
43  Item9 Item6    0.5849045  0.6643001 -0.079395555           0.07880    FALSE
44  Item9 Item7    0.5653926  0.5905836 -0.025191060           0.33045    FALSE
45  Item9 Item8    0.6068774  0.6608282 -0.053950800           0.15570    FALSE
   ppmcCorr.y   residual.y observedCorrPCT.y inTail.y
1   0.4062453 -0.149411838          0.021375     TRUE
2   0.4741188 -0.061992441          0.208000    FALSE
3   0.4396909  0.127324771          0.954625    FALSE
4   0.4789946 -0.027382240          0.337625    FALSE
5   0.5336977  0.048522599          0.736750    FALSE
6   0.5316488 -0.022448494          0.350250    FALSE
7   0.4725387 -0.030518156          0.338000    FALSE
8   0.5166837  0.029028985          0.646500    FALSE
9   0.4749625 -0.050470922          0.258750    FALSE
10  0.5225588  0.079859795          0.897625    FALSE
11  0.4845009 -0.137193683          0.025250    FALSE
12  0.5407355 -0.023053619          0.348375    FALSE
13  0.5350439  0.035046168          0.693625    FALSE
14  0.5943265 -0.012745647          0.396500    FALSE
15  0.5518686 -0.054469852          0.197875    FALSE
16  0.5823830 -0.029775722          0.296250    FALSE
17  0.6655675 -0.014290652          0.375000    FALSE
18  0.6060217 -0.011805479          0.396875    FALSE
19  0.6653200 -0.038603963          0.219375    FALSE
20  0.5827271 -0.039150054          0.242750    FALSE
21  0.6534385  0.030089655          0.701875    FALSE
22  0.6077661  0.052363175          0.802875    FALSE
23  0.6669047 -0.041759184          0.201375    FALSE
24  0.7328579  0.003831089          0.509500    FALSE
25  0.5004824 -0.092043558          0.087625    FALSE
26  0.5787187 -0.106555900          0.051250    FALSE
27  0.5271264  0.092200572          0.912500    FALSE
28  0.5763177 -0.108634364          0.048625    FALSE
29  0.6497289 -0.029280447          0.293375    FALSE
30  0.6379156  0.049114716          0.802500    FALSE
31  0.5730756 -0.030559026          0.295375    FALSE
32  0.6518795 -0.020108970          0.331750    FALSE
33  0.5950893  0.023184359          0.626625    FALSE
34  0.6538394 -0.016509531          0.355250    FALSE
35  0.7305302  0.033640008          0.771125    FALSE
36  0.7215552  0.034180334          0.770375    FALSE
37  0.6364697  0.024677809          0.647000    FALSE
38  0.5001129 -0.058026879          0.189375    FALSE
39  0.5797217  0.020114922          0.602250    FALSE
40  0.5287277 -0.137454306          0.028625    FALSE
41  0.5774416  0.033363627          0.688875    FALSE
42  0.6522837  0.059652847          0.848125    FALSE
43  0.6383018 -0.053397216          0.170875    FALSE
44  0.5700175 -0.004624969          0.456375    FALSE
45  0.6362707 -0.029393327          0.285125    FALSE</code></pre>
</div>
</div>
</section>
<section id="count-of-items-in-misfitting-pairs" class="slide level2">
<h2>Count of Items in Misfitting Pairs</h2>
<p>One <span class="math inline">\(\theta\)</span></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>badItems
 Item1  Item3 Item10  Item4  Item7  Item9 
     2      2      1      1      1      1 </code></pre>
</div>
</div>
<p>Two <span class="math inline">\(\theta\)</span>s</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>badItems2
 Item1 Item10 
     1      1 </code></pre>
</div>
</div>
</section>
<section id="plotting-misfitting-items-one-theta" class="slide level2">
<h2>Plotting Misfitting Items (One <span class="math inline">\(\theta\)</span>)</h2>
<div class="cell">
<div class="cell-output-display">
<div id="htmlwidget-1a60c03cdce1b7239354" style="width:960px;height:480px;" class="forceNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-1a60c03cdce1b7239354">{"x":{"links":{"source":[2,1,5,4],"target":[0,0,2,3],"value":[1,1,1,1],"colour":["#666","#666","#666","#666"]},"nodes":{"name":["Item1","Item10","Item3","Item4","Item7","Item9"],"group":[1,1,1,1,1,1],"nodesize":[8,8,8,8,8,8]},"options":{"NodeID":"name","Group":"group","colourScale":"d3.scaleOrdinal(['#3182bd'])","fontSize":7,"fontFamily":"serif","clickTextSize":17.5,"linkDistance":50,"linkWidth":"'1.5px'.toString()","charge":-30,"opacity":0.6,"zoom":false,"legend":false,"arrows":false,"nodesize":true,"radiusCalculation":"d.nodesize","bounded":false,"opacityNoHover":1,"clickAction":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="section-1" class="slide level2" data-auto-animate="true," data-visibility="uncounted">
<h2 data-id="quarto-animate-title"></h2>
<div style="margin-top: 200px; font-size: 3em; color: red;">
<p>Relative Model Fit in Bayesian Psychometric Models</p>
</div>
</section>
<section id="relative-model-fit-in-bayesian-psychometric-models" class="slide level2">
<h2>Relative Model Fit in Bayesian Psychometric Models</h2>
<p>As with other Bayesian models, we can use WAIC and LOO to compare the model fit of two Bayesian models</p>
<ul>
<li>Of note: There is some debate as to whether or not we should marginalize across the latent variables
<ul>
<li>We won’t do that here as that would involve a numeric integral</li>
</ul></li>
<li>What is needed: The conditional log likelihood for each observation at each step of the chain
<ul>
<li>Here, we have to sum the log likelihood across all items</li>
<li>There are built-in functions in Stan to do this</li>
</ul></li>
</ul>
</section>
<section id="implementing-elpd-in-stan-one-theta" class="slide level2">
<h2>Implementing ELPD in Stan (one <span class="math inline">\(\theta\)</span>)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>generated quantities{</span>
<span id="cb12-2"><a href="#cb12-2"></a>  </span>
<span id="cb12-3"><a href="#cb12-3"></a>  <span class="sc">/</span><span class="er">/</span> <span class="cf">for</span> LOO<span class="sc">/</span>WAIC<span class="sc">:</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>  vector[nObs] personLike <span class="ot">=</span> <span class="fu">rep_vector</span>(<span class="fl">0.0</span>, nObs);</span>
<span id="cb12-5"><a href="#cb12-5"></a>  </span>
<span id="cb12-6"><a href="#cb12-6"></a>  <span class="cf">for</span> (item <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nItems){</span>
<span id="cb12-7"><a href="#cb12-7"></a>    <span class="cf">for</span> (obs <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nObs){</span>
<span id="cb12-8"><a href="#cb12-8"></a>      <span class="sc">/</span><span class="er">/</span> calculate conditional data likelihood <span class="cf">for</span> LOO<span class="sc">/</span>WAIC</span>
<span id="cb12-9"><a href="#cb12-9"></a>      personLike[obs] <span class="ot">=</span> personLike[obs] <span class="sc">+</span> <span class="fu">ordered_logistic_lpmf</span>(Y[item, obs] <span class="sc">|</span> lambda[item]<span class="sc">*</span>theta[obs], thr[item]);</span>
<span id="cb12-10"><a href="#cb12-10"></a>    }</span>
<span id="cb12-11"><a href="#cb12-11"></a>  }</span>
<span id="cb12-12"><a href="#cb12-12"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notes:</p>
<ul>
<li><code>ordered_logistic_lpmf</code> needs the observed data to work (first argument)</li>
<li><code>vector[nObs] personLike = rep_vector(0.0, nObs);</code> is needed to set the values to zero at each iteration</li>
</ul>
</section>
<section id="implementing-elpd-in-stan-two-thetas" class="slide level2">
<h2>Implementing ELPD in Stan (two <span class="math inline">\(\theta\)</span>s)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>generated quantities{ </span>
<span id="cb13-2"><a href="#cb13-2"></a> </span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="sc">/</span><span class="er">/</span> <span class="cf">for</span> LOO<span class="sc">/</span>WAIC<span class="sc">:</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>  vector[nObs] personLike <span class="ot">=</span> <span class="fu">rep_vector</span>(<span class="fl">0.0</span>, nObs);</span>
<span id="cb13-5"><a href="#cb13-5"></a>  </span>
<span id="cb13-6"><a href="#cb13-6"></a>  <span class="cf">for</span> (item <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nItems){</span>
<span id="cb13-7"><a href="#cb13-7"></a>    <span class="cf">for</span> (obs <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nObs){</span>
<span id="cb13-8"><a href="#cb13-8"></a>      <span class="sc">/</span><span class="er">/</span> calculate conditional data likelihood <span class="cf">for</span> LOO<span class="sc">/</span>WAIC</span>
<span id="cb13-9"><a href="#cb13-9"></a>      personLike[obs] <span class="ot">=</span> personLike[obs] <span class="sc">+</span> <span class="fu">ordered_logistic_lpmf</span>(Y[item, obs] <span class="sc">|</span> thetaMatrix[obs,]<span class="sc">*</span>lambdaMatrix[item,<span class="dv">1</span><span class="sc">:</span>nFactors]<span class="st">', thr[item]);</span></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="st">    }</span></span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="st">  }  </span></span>
<span id="cb13-12"><a href="#cb13-12"></a><span class="st">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notes:</p>
<ul>
<li><code>ordered_logistic_lpmf</code> needs the observed data to work (first argument)</li>
<li><code>vector[nObs] personLike = rep_vector(0.0, nObs);</code> is needed to set the values to zero at each iteration</li>
</ul>
</section>
<section id="comparing-waic-values" class="slide level2">
<h2>Comparing WAIC Values</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># model comparisons</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="fu">waic</span>(<span class="at">x =</span> modelOrderedLogit_samples<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"personLike"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Computed from 20000 by 177 log-likelihood matrix

          Estimate    SE
elpd_waic  -1482.6  70.4
p_waic       137.7   5.1
waic        2965.2 140.8

173 (97.7%) p_waic estimates greater than 0.4. We recommend trying loo instead. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">waic</span>(<span class="at">x =</span> modelOrderedLogit2D_samples<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"personLike"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Computed from 8000 by 177 log-likelihood matrix

          Estimate    SE
elpd_waic  -1490.6  68.0
p_waic       142.6   4.6
waic        2981.1 136.1

174 (98.3%) p_waic estimates greater than 0.4. We recommend trying loo instead. </code></pre>
</div>
</div>
<p>Smaller is better, so the unidimensional model wins (but very high SE for both)</p>
</section>
<section id="comparing-loo-values" class="slide level2">
<h2>Comparing LOO Values</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>modelOrderedLogit_samples<span class="sc">$</span><span class="fu">loo</span>(<span class="at">variables =</span> <span class="st">"personLike"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Computed from 20000 by 177 log-likelihood matrix

         Estimate    SE
elpd_loo  -1542.0  71.0
p_loo       197.1   5.8
looic      3084.0 141.9
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)       0    0.0%   &lt;NA&gt;      
 (0.5, 0.7]   (ok)         4    2.3%   426       
   (0.7, 1]   (bad)      156   88.1%   31        
   (1, Inf)   (very bad)  17    9.6%   10        
See help('pareto-k-diagnostic') for details.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>modelOrderedLogit2D_samples<span class="sc">$</span><span class="fu">loo</span>(<span class="at">variables =</span> <span class="st">"personLike"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Computed from 8000 by 177 log-likelihood matrix

         Estimate    SE
elpd_loo  -1541.3  68.1
p_loo       193.2   5.1
looic      3082.5 136.2
------
Monte Carlo SE of elpd_loo is NA.

Pareto k diagnostic values:
                         Count Pct.    Min. n_eff
(-Inf, 0.5]   (good)       1    0.6%   743       
 (0.5, 0.7]   (ok)        19   10.7%   42        
   (0.7, 1]   (bad)      135   76.3%   4         
   (1, Inf)   (very bad)  22   12.4%   4         
See help('pareto-k-diagnostic') for details.</code></pre>
</div>
</div>
<p>LOO seems to (slightly) prefer the two-dimensional model (but by warnings about bad PSIS)</p>
</section>
<section id="comparing-loo-values-1" class="slide level2">
<h2>Comparing LOO Values</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">loo_compare</span>(<span class="fu">list</span>(<span class="at">unidimensional =</span> modelOrderedLogit_samples<span class="sc">$</span><span class="fu">loo</span>(<span class="at">variables =</span> <span class="st">"personLike"</span>), </span>
<span id="cb22-2"><a href="#cb22-2"></a>                 <span class="at">twodimensional =</span> modelOrderedLogit2D_samples<span class="sc">$</span><span class="fu">loo</span>(<span class="at">variables =</span> <span class="st">"personLike"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               elpd_diff se_diff
twodimensional  0.0       0.0   
unidimensional -0.7       4.9   </code></pre>
</div>
</div>
<p>Again, both models are very close in fit</p>
</section>
<section id="section-2" class="slide level2" data-auto-animate="true," data-visibility="uncounted">
<h2 data-id="quarto-animate-title"></h2>
<div style="margin-top: 200px; font-size: 3em; color: red;">
<p>Wrapping Up</p>
</div>
</section>
<section id="wrapping-up" class="slide level2">
<h2>Wrapping Up</h2>
<p>Model fit is complicated for psychometric models</p>
<ul>
<li>Bayesian model fit methods are even more complicated than non-Bayesian methods</li>
<li>Open area for research!</li>
</ul>
<div style="margin-top: 200px; font-size: 3em; color: red;">
<p>Thank you for a great semester</p>
</div>
<div class="footer footer-default">
<p><a href="https://jonathantemplin.com/bayesian-psychometric-modeling-fall-2022/">https://jonathantemplin.com/bayesian-psychometric-modeling-fall-2022/</a></p>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="05_Bayesian_Psychometric_Model_Fit_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="05_Bayesian_Psychometric_Model_Fit_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="05_Bayesian_Psychometric_Model_Fit_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="05_Bayesian_Psychometric_Model_Fit_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="05_Bayesian_Psychometric_Model_Fit_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="05_Bayesian_Psychometric_Model_Fit_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="05_Bayesian_Psychometric_Model_Fit_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="05_Bayesian_Psychometric_Model_Fit_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="05_Bayesian_Psychometric_Model_Fit_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="05_Bayesian_Psychometric_Model_Fit_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>